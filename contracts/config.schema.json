{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "contracts/config.schema.json",
  "title": "Truth Core Configuration",
  "description": "Configuration schema for truth-core runtime settings",
  "type": "object",
  "required": ["version"],
  "additionalProperties": false,
  "properties": {
    "version": {
      "type": "string",
      "pattern": "^\\d+\\.\\d+\\.\\d+$",
      "description": "Configuration schema version"
    },
    "profile": {
      "type": "string",
      "enum": ["base", "ui", "readylayer", "settler", "aias", "keys"],
      "description": "Verification profile to use"
    },
    "mode": {
      "type": "string",
      "enum": ["pr", "main", "release"],
      "description": "Execution mode"
    },
    "cache": {
      "type": "object",
      "properties": {
        "enabled": { "type": "boolean", "default": true },
        "dir": { "type": "string", "default": ".truthcache" },
        "max_age_days": { "type": "integer", "minimum": 1, "default": 30 }
      },
      "additionalProperties": false
    },
    "thresholds": {
      "type": "object",
      "properties": {
        "min_score": { "type": "number", "minimum": 0, "maximum": 100 },
        "max_blockers": { "type": "integer", "minimum": 0 },
        "max_highs": { "type": "integer", "minimum": 0 },
        "max_total_points": { "type": "integer", "minimum": 0 }
      },
      "additionalProperties": false
    },
    "engines": {
      "type": "object",
      "properties": {
        "disabled": {
          "type": "array",
          "items": { "type": "string" }
        },
        "config": {
          "type": "object",
          "additionalProperties": true
        }
      },
      "additionalProperties": false
    },
    "output": {
      "type": "object",
      "properties": {
        "format": {
          "type": "string",
          "enum": ["json", "markdown", "csv", "all"],
          "default": "all"
        },
        "dir": { "type": "string" },
        "manifest": { "type": "boolean", "default": true }
      },
      "additionalProperties": false
    },
    "security": {
      "type": "object",
      "properties": {
        "signing_key_path": { "type": "string" },
        "public_key_path": { "type": "string" },
        "max_file_size_mb": { "type": "integer", "minimum": 1, "default": 100 },
        "max_json_depth": { "type": "integer", "minimum": 1, "default": 50 }
      },
      "additionalProperties": false
    }
  }
}
